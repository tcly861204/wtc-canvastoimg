"use strict";var _createClass=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Canvastoimg=function(){function e(t){_classCallCheck(this,e),t&&(this.isLoaded=!1,this.isDown=!1,this.options=t,this.initData())}return _createClass(e,[{key:"initData",value:function(){this.options.data.sort(function(t,e){return t.zIndex-e.zIndex}),this.createdCanvas()}},{key:"createdCanvas",value:function(){this.oCanvas=document.createElement("canvas"),this.oCanvas.width=this.options.width,this.oCanvas.height=this.options.height,this.oCtx=this.oCanvas.getContext("2d"),this.oCtx.fillStyle=this.options.color,this.oCtx.fillRect(0,0,this.oCanvas.width,this.oCanvas.height),this.createElements()}},{key:"createElements",value:function(){var e=this;if(this.options.data.length<1)this.isLoaded=!0;else{var i=this.options.data[0];"text"===i.type?(this.oCtx.fillStyle=i.color,this.oCtx.font=i.fontSize,this.oCtx.fillText(i.content,i.x,i.y),this.options.data.shift(),this.createElements()):"img"===i.type&&new Promise(function(t,e){var n=new Image;n.crossOrigin="anonymous",n.src=i.content,n.onload=function(){t(n)}}).then(function(t){e.oCtx.drawImage(t,i.x,i.y,i.width,i.height),e.options.data.shift(),e.createElements()})}}},{key:"down",value:function(){var n=this;return this.timer=null,new Promise(function(t,e){n.isLoaded?(n.isDown=!1,t(n.oCanvas)):(clearInterval(n.timer),n.timer=setInterval(function(){n.isLoaded&&(n.isDown=!1,t(n.oCanvas))},100))})}}]),e}();module.exports=Canvastoimg;